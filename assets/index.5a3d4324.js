var ie=Object.defineProperty,oe=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var I=(a,e,n)=>e in a?ie(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n,w=(a,e)=>{for(var n in e||(e={}))le.call(e,n)&&I(a,n,e[n]);if(Q)for(var n of Q(e))ce.call(e,n)&&I(a,n,e[n]);return a},F=(a,e)=>oe(a,re(e));var y=(a,e,n)=>(I(a,typeof e!="symbol"?e+"":e,n),n);import{j as B,m as Z,r as x,a as z,M as de,v as pe,Q as ue,R as fe,b as me}from"./vendor.2c6bff34.js";const he=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))t(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function t(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}};he();const o=B.exports.jsx,_=B.exports.jsxs,E=B.exports.Fragment;function ge({value:a,fieldDefinition:e,setField:n}){return _("div",{className:"flex flex-row justify-between items-center",children:[_("div",{className:"flex flex-col",children:[o("span",{className:"text-l font-bold",children:e.name}),e.description?o("span",{className:"text-sm",children:e.description}):o(E,{})]}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:typeof a=="number"?"number":"text",value:a,onChange:t=>{n(typeof a=="number"?Number.parseFloat(t.target.value):t.target.value)}})})]})}function _e({title:a,item:e,setItem:n,fieldDefinitions:t}){const i=Object.keys(e).map((s,l)=>{const p=e[s],d=s in t&&t[s];return d?{element:o(ge,{value:p,fieldDefinition:d,setField:m=>n({[s]:m})}),order:d.order}:{element:_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:s}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:typeof p=="number"?"number":"text",value:p,onChange:m=>{n({[s]:typeof p=="number"?Number.parseFloat(m.target.value):m.target.value})}})})]}),order:l+1e3}}).sort((s,l)=>s.order-l.order).map(s=>s.element);return _("div",{className:"flex flex-col gap-2 border-2 rounded p-2 max-h-96 overflow-y-auto",children:[o("span",{className:"text-xl font-bold",children:a}),i]})}const we={color:"#0000ff",selectedColor:"#ff0000",radius:6};var ne;const ye=JSON.parse((ne=window.localStorage.getItem("blockDisplaySettings"))!=null?ne:"false")||we;function xe({settings:a,setSettings:e,selected:n,blocks:t,setBlockData:i}){const s=d=>{e(d),window.localStorage.setItem("blockDisplaySettings",JSON.stringify(d))},l=t[n],p=l?o(_e,{title:l.name,item:l,setItem:d=>i(n,d),fieldDefinitions:{name:{order:0,name:"Name",description:"The Block Name",type:"string"}}}):o(E,{});return _(E,{children:[_("div",{className:"flex flex-col gap-2",children:[_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Color"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"color",value:a.color,onChange:d=>{s(F(w({},a),{color:d.target.value}))}})})]}),_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Selected Color"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"color",value:a.selectedColor,onChange:d=>{s(F(w({},a),{selectedColor:d.target.value}))}})})]}),_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Radius"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"range",min:"2",max:"10",step:"0.5",value:a.radius,onChange:d=>{s(F(w({},a),{radius:Number.parseFloat(d.target.value)}))}})})]})]}),p]})}function be({folder:a,files:e,setFile:n}){const t=Object.keys(e).map(i=>{const s=e[i];return _("div",{className:"flex flex-row justify-between items-center",children:[_("div",{className:"flex flex-col",children:[o("span",{className:"text-l font-bold","data-testid":`file-${i}-label`,children:s.name}),o("span",{className:"text-sm","data-testid":`file-${i}-description`,children:s.description})]}),o("span",{className:"w-2/5 flex-shrink-0",children:_("select",{"data-testid":`file-${i}-select`,className:"w-full rounded",value:s.currentFilePath,onChange:async l=>{const p=l.currentTarget.value;try{const d=await a.getFile(p);n(i,d.name,d)}catch{n(i,"")}},children:[o("option",{value:"","data-testid":`file-${i}-empty`,children:"\xA0"}),a.fileList.filter(l=>l.endsWith(s.extension)).map(l=>o("option",{value:l,"data-testid":`file-${i}-select-${l}`,children:l},l))]})})]},i)});return o("div",{className:"flex flex-col gap-2",children:t})}function ve({view:a,buttons:e,active:n,setActive:t}){if(!e)return o("span",{});const i=[];for(const s of Object.keys(e)){const l=e[s],p=s===n;i.push(o("button",{type:"button","data-testid":`tab-${s}`,className:`${p?"bg-gray-100":"bg-gray-300"} p-2 shadow-inner hover:bg-gray-200 rounded-t`,onClick:()=>t(p?"":s),children:l},s))}return _("div",{"data-testid":"inspector-container",className:"absolute bottom-0 right-2 h-1/2 w-1/3 flex flex-col-reverse z-50",children:[n?o("div",{"data-testid":"inspector-view",className:"flex flex-col bg-gray-100 flex-grow rounded-tr p-2",children:a}):"",o("div",{"data-testid":"inspector-tabs",className:"flex flex-row rounded-sm gap-0 divide-x divide-gray-200",children:i})]})}Z.accessToken="pk.eyJ1IjoiYnJlbmRhbmptZWFkZSIsImEiOiJja3g2ZzVueWMybTJtMzFwaHdzZmV5OGJvIn0.Oz8qQnu5b-jx8XFHlFnKDQ";const P=Math.PI/6,A=2*Math.PI-P;function Ne({pointSources:a,arrowSources:e}){const n=x.exports.useRef(null),[t,i]=x.exports.useState(),[s,l]=x.exports.useState(!1),[p,d]=x.exports.useState(),[m]=x.exports.useState(new z.exports.Popup({closeButton:!1,closeOnClick:!1})),[h,C]=x.exports.useState(),[$,M]=x.exports.useState();return x.exports.useEffect(()=>{if(!t&&Z.accessToken&&n.current){const r=new z.exports.Map({container:n.current,style:"mapbox://styles/mapbox-public/ckngin2db09as17p84ejhe24y",center:[0,0],zoom:2});r.addControl(new z.exports.NavigationControl);const b=new de({displayControlsDefault:!1,controls:{line_string:!0,trash:!0},defaultMode:"simple_select"});r.addControl(b),i(r),d(b),r.on("load",()=>{l(!0)})}console.log("Updating map...")},[t,p]),x.exports.useEffect(()=>{if(console.log("Adding layers"),t&&s&&h!==a)if(console.log("Setting points in map!"),h){for(const r of h){const b=t.getSource(`point:${r.name}`);b!==void 0&&b.setData({type:"FeatureCollection",features:[]}),t.removeLayer(`layer:point:${r.name}`);const N=t.getSource(`point:${r.name}:selected`);N!==void 0&&N.setData({type:"FeatureCollection",features:[]}),t.removeLayer(`layer:point:${r.name}:selected`)}C(void 0)}else{for(const r of a){let b=t.getSource(`point:${r.name}`),N=t.getSource(`point:${r.name}:selected`);const f=b===void 0;f&&(t.addSource(`point:${r.name}`,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),b=t.getSource(`point:${r.name}`),t.addSource(`point:${r.name}:selected`,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),N=t.getSource(`point:${r.name}:selected`)),b!==void 0&&N!==void 0&&(b.setData({type:"FeatureCollection",features:r.points.filter(c=>!c.selected).map(c=>({type:"Feature",properties:{description:`<strong>${c.name}</strong><p>${c.description}</p>`,index:c.index,name:c.name},geometry:{type:"Point",coordinates:[c.longitude,c.latitude]}}))}),N.setData({type:"FeatureCollection",features:r.points.filter(c=>c.selected).map(c=>({type:"Feature",properties:{description:`<strong>${c.name}</strong><p>${c.description}</p>`,index:c.index,name:c.name},geometry:{type:"Point",coordinates:[c.longitude,c.latitude]}}))})),t.addLayer({id:`layer:point:${r.name}`,type:"circle",source:`point:${r.name}`,paint:{"circle-color":r.color,"circle-radius":r.radius,"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}),t.addLayer({id:`layer:point:${r.name}:selected`,type:"circle",source:`point:${r.name}:selected`,paint:{"circle-color":r.selectedColor,"circle-radius":r.radius,"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}),f&&(t.on("mouseenter",`layer:point:${r.name}`,c=>{if(!c.features)return;const g=c.features[0];if(g.geometry.type==="Point"&&g.properties&&typeof g.properties.description=="string"){const v=[...g.geometry.coordinates],{description:S}=g.properties;for(;Math.abs(c.lngLat.lng-v[0])>180;)v[0]+=c.lngLat.lng>v[0]?360:-360;m.setLngLat(v).setHTML(S).addTo(t)}}),t.on("mouseleave",`layer:point:${r.name}`,()=>{m.remove()}),t.on("click",`layer:point:${r.name}`,c=>{if(!c.features||!r.clickPoint)return;const g=c.features[0];if(g.properties&&typeof g.properties.index=="number"&&typeof g.properties.name=="string"){const{index:v,name:S}=g.properties;r.clickPoint(v,S)}}))}C(a)}},[t,h,a,s,m]),x.exports.useEffect(()=>{if(console.log("Adding layers"),t&&s&&$!==e)if(console.log("Setting arrows in map!"),$){for(const r of $){const b=t.getSource(`arrow:${r.name}`);b!==void 0&&b.setData({type:"FeatureCollection",features:[]}),t.removeLayer(`layer:arrow:${r.name}`)}M(void 0)}else{for(const r of e){let b=t.getSource(`arrow:${r.name}`);const N=b===void 0;N&&(t.addSource(`arrow:${r.name}`,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),b=t.getSource(`arrow:${r.name}`)),b!==void 0&&b.setData({type:"FeatureCollection",features:r.arrows.map((f,c)=>{const g=f.scale*r.scale,v=r.scale*r.arrowHeadScale,S=[f.longitude+f.direction[0]*g,f.latitude+f.direction[1]*g],O=[S[0]+(Math.cos(P)*-f.direction[0]-Math.sin(P)*-f.direction[1])*v,S[1]+(Math.sin(P)*-f.direction[0]+Math.cos(P)*-f.direction[1])*v],u=[S[0]+(Math.cos(A)*-f.direction[0]-Math.sin(A)*-f.direction[1])*v,S[1]+(Math.sin(A)*-f.direction[0]+Math.cos(A)*-f.direction[1])*v];return{type:"Feature",properties:{description:`<strong>${f.name}</strong><p>${f.description}</p>`,index:c,name:f.name},geometry:{type:"LineString",coordinates:[[f.longitude,f.latitude],S,O,S,u]}}})}),t.addLayer({id:`layer:arrow:${r.name}`,type:"line",source:`arrow:${r.name}`,layout:{"line-cap":"round","line-join":"miter"},paint:{"line-color":r.color,"line-width":r.width}}),N&&(t.on("mouseenter",`layer:arrow:${r.name}`,f=>{if(!f.features)return;const c=f.features[0];if(c.geometry.type==="Point"&&c.properties&&typeof c.properties.description=="string"){const g=[...c.geometry.coordinates],{description:v}=c.properties;for(;Math.abs(f.lngLat.lng-g[0])>180;)g[0]+=f.lngLat.lng>g[0]?360:-360;m.setLngLat(g).setHTML(v).addTo(t)}}),t.on("mouseleave",`layer:arrow:${r.name}`,()=>{m.remove()}),t.on("click",`layer:arrow:${r.name}`,f=>{if(!f.features||!r.clickArrow)return;const c=f.features[0];if(c.properties&&typeof c.properties.index=="number"&&typeof c.properties.name=="string"){const{index:g,name:v}=c.properties;r.clickArrow(g,v)}}))}M(e)}},[t,$,e,s,m]),o("div",{"data-testid":"map",className:"w-full h-full",ref:n})}function Se({folder:a,openFolder:e,filesOpen:n,saveFiles:t}){function i(){e()}return _("div",{"data-testid":"topbar",className:"p-2 bg-gradient-to-r from-blue-700 to-green-700 text-white flex flex-row justify-between",children:[o("h3",{className:"text-lg font-bold",children:"Celeri UI"}),_("span",{"data-testid":"open-folder-topbar",className:"flex flex-row gap-2 items-center",children:[a?_("span",{children:["Working in ",a.name]}):o("button",{type:"button",onClick:i,"data-testid":"open-folder-button",children:"Open Folder"}),n?o("button",{type:"button",onClick:t,"data-testid":"save-file-button",children:"Save Files"}):o(E,{})]})]})}const ke={color:"#ffff00",scale:.02,width:1,arrowHead:1};var se;const Fe=JSON.parse((se=window.localStorage.getItem("velocityDisplaySettings"))!=null?se:"false")||ke;function Ce({settings:a,setSettings:e}){const n=t=>{e(t),window.localStorage.setItem("velocityDisplaySettings",JSON.stringify(t))};return _("div",{className:"flex flex-col gap-2",children:[_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Color"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"color",value:a.color,onChange:t=>{n(F(w({},a),{color:t.target.value}))}})})]}),_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Scale"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"range",min:"0.001",max:"0.1",step:"0.001",value:a.scale,onChange:t=>{n(F(w({},a),{scale:Number.parseFloat(t.target.value)}))}})})]}),_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Width"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"range",min:"0.1",max:"2",step:"0.1",value:a.width,onChange:t=>{n(F(w({},a),{width:Number.parseFloat(t.target.value)}))}})})]}),_("div",{className:"flex flex-row justify-between items-center",children:[o("span",{className:"text-l font-bold",children:"Arrow Head Size"}),o("span",{className:"w-2/5 flex-shrink-0",children:o("input",{className:"rounded w-full",type:"range",min:"0.5",max:"5",step:"0.1",value:a.arrowHead,onChange:t=>{n(F(w({},a),{arrowHead:Number.parseFloat(t.target.value)}))}})})]})]})}function R(a){const e=a.split(/\n/g),n=e[0].split(","),t=e.slice(1),i=[];for(const s of t){const l=s.split(/\s*,\s*/),p={};for(let d=0;d<n.length;d+=1){let m=l[d];const h=n[d],C=Number.parseFloat(m);m=Number.isNaN(C)?m:C,typeof m=="string"&&m.startsWith('"')&&m.endsWith('"')&&(m=m.slice(1,-1)),p[h]=m}i.push(p)}return i}function H(a,e){const n=[e.join(",")];for(const t of a){const i=t;n.push(e.map(s=>s in i?typeof i[s]=="string"&&/\s/.test(`${i[s]}`)?`"${i[s]}"`:`${i[s]}`:"").join(","))}return n.join(`
`)}const U=["other1","other2","other3","other4","other5","other6","name","interior_lon","interior_lat","euler_lon","euler_lon_sig","euler_lat","euler_lat_sig","rotation_rate","rotation_rate_sig","rotation_flag","apriori_flag","strain_rate","strain_rate_sig","strain_rate_flag"],$e={other1:0,other2:0,other3:0,other4:0,other5:0,other6:0,name:"",interior_lon:0,interior_lat:0,euler_lon:0,euler_lon_sig:0,euler_lat:0,euler_lat_sig:0,rotation_rate:0,rotation_rate_sig:0,rotation_flag:0,apriori_flag:0,strain_rate:0,strain_rate_sig:0,strain_rate_flag:0};function Le(a){return w(w({},$e),a)}class T{constructor(e){y(this,"handle");y(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),t=R(e).map(i=>{const s={};for(const l of U)s[l]=i[l]||(l==="name"?"":0);return s});this.data=t}async save(){var n;const e=H((n=this.data)!=null?n:[],U);await this.handle.setContents(e)}clone(){return new T(this.handle)}}const je={file_name:"basic_command_default_values.json",reuse_elastic:"no",reuse_elastic_file:"./celeri_elastic_operators.hdf5",save_elastic:"yes",save_elastic_file:"./celeri_elastic_operators.hdf5",material_lambda:3e10,material_mu:3e10,unit_sigmas:"no",locking_depth_flag2:0,locking_depth_flag3:0,locking_depth_flag4:0,locking_depth_flag5:0,locking_depth_override_flag:"no",locking_depth_overide_value:0,apriori_block_name:"",tri_smooth:1e4,pmag_tri_smooth:0,smooth_type:1,n_iterations:1,tri_edge:[0,0,0],tri_depth_tolerance:0,tri_con_weight:1,strain_method:0,sar_file_name:"",sar_ramp:0,sar_weight:0,tri_slip_constraint_type:0,inversion_type:"standard",inversion_param01:0,inversion_param02:0,inversion_param03:0,inversion_param04:0,inversion_param05:0,save_all:"yes",mogi_file_name:"",solution_method:"backslash",ridge_param:0,tri_full_coupling:"no",tvr_lambda:1,tri_slip_sign:[0,0],n_eigs:0,segment_file_name:"",station_file_name:"",block_file_name:"",mesh_parameters_file_name:"",fault_resolution:1,station_data_weight:1,station_data_weight_min:1,station_data_weight_max:1,station_data_weight_steps:1,slip_constraint_weight:1,slip_constraint_weight_min:1,slip_constraint_weight_max:1,slip_constraint_weight_steps:1,block_constraint_weight:1,block_constraint_weight_min:1,block_constraint_weight_max:1,block_constraint_weight_steps:1,slip_file_names:""};function De(a){return w(w({},je),a)}class V{constructor(e){y(this,"handle");y(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),n=JSON.parse(e);this.data=De(n)}async save(){if(this.data){const e=JSON.stringify(this.data);await this.handle.setContents(e)}}clone(){return new V(this.handle)}}const K=["name","lon1","lat1","lon2","lat2","dip","res","other3","other6","other7","other8","other9","other10","other11","other12","locking_depth","locking_depth_sig","locking_depth_flag","dip_sig","dip_flag","ss_rate","ss_rate_sig","ss_rate_flag","ds_rate","ds_rate_sig","ds_rate_flag","ts_rate","ts_rate_sig","ts_rate_flag","burial_depth","burial_depth_sig","burial_depth_flag","resolution_override","resolution_other","patch_file_name","patch_flag","patch_slip_file","patch_slip_flag"];class W{constructor(e){y(this,"handle");y(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),t=R(e).map(i=>{const s={};for(const l of K)s[l]=i[l]||(l==="name"?"":0);return s});this.data=t}async save(){var n;const e=H((n=this.data)!=null?n:[],K);await this.handle.setContents(e)}clone(){return new W(this.handle)}}const X=["lon","lat","corr","other1","name","east_vel","north_vel","east_sig","north_sig","flag","up_vel","up_sig","east_adjust","north_adjust","up_adjust"];class J{constructor(e){y(this,"handle");y(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),t=R(e).map(i=>{const s={};for(const l of X)s[l]=i[l]||(l==="name"?"":0);return s});this.data=t}async save(){var n;const e=H((n=this.data)!=null?n:[],X);await this.handle.setContents(e)}clone(){return new J(this.handle)}}async function Y(a){const e=new W(a);return await e.initialize(),e}async function ee(a){const e=new T(a);return await e.initialize(),e}async function te(a){const e=new J(a);return await e.initialize(),e}async function Me(a,e,n){const t=new V(e);if(await t.initialize(),t.data){const i=await Y(await a.getFile(t.data.segment_file_name)),s=await ee(await a.getFile(t.data.block_file_name)),l=await te(await a.getFile(t.data.station_file_name)),p=w({},n);return"command"in p&&(p.command=F(w({},p.command),{currentFilePath:e.name})),"segment"in p&&(p.segment=F(w({},p.segment),{currentFilePath:t.data.segment_file_name})),"block"in p&&(p.block=F(w({},p.block),{currentFilePath:t.data.block_file_name})),"velocities"in p&&(p.velocities=F(w({},p.velocities),{currentFilePath:t.data.station_file_name})),{openableFiles:p,commands:t,segments:i,blocks:s,velocities:l}}throw new Error("Can't open command file")}class Pe{constructor(e){y(this,"name");y(this,"handle");this.handle=e,this.name=e.name}async getContents(){return(await this.handle.getFile()).text()}async setContents(e){const n=await this.handle.createWritable();await n.write(e),await n.close()}}class q{constructor(e){y(this,"name");y(this,"handle");y(this,"fileList");y(this,"folderList");this.handle=e,this.fileList=[],this.folderList=[],this.name=e.name}async initialize(){for await(const e of this.handle.values())e.kind==="directory"?this.folderList.push(e.name):this.fileList.push(e.name)}async getFile(e){if(!this.fileList.includes(e))throw new Error("Missing File");const n=await this.handle.getFileHandle(e);return new Pe(n)}async getDirectory(e){if(!this.folderList.includes(e))throw new Error("Missing Directory");const n=await this.handle.getDirectoryHandle(e),t=new q(n);return await t.initialize(),t}}const Oe=async()=>{const a=await window.showDirectoryPicker(),e=new q(a);return await e.initialize(),e};class Ee{constructor(e,n){y(this,"name");y(this,"parent");this.name=e,this.parent=n}async getContents(){const e=this.parent[this.name];if(typeof e!="string")throw new Error("No Such File");return e}async setContents(e){this.parent[this.name]=e}}class G{constructor(e,n){y(this,"name");y(this,"parent");y(this,"fileList");y(this,"folderList");this.name=e,this.parent=n,this.fileList=[],this.folderList=[];const t=n[e];for(const i of Object.keys(t))typeof t[i]=="string"?this.fileList.push(i):this.folderList.push(i)}async getFile(e){if(!this.fileList.includes(e))throw new Error("No Such File");return new Ee(e,this.parent[this.name])}async getDirectory(e){if(!this.folderList.includes(e))throw new Error("No Such File");return new G(e,this.parent[this.name])}}const Ae=async a=>new G("root",a);let ae=async()=>{var e;return Ae((e=window.FakeDirectory)!=null?e:{})};function Ie(a){ae=a}async function Be(){return ae()}window.location.search.includes("fake-dir")||Ie(Oe);const ze={files:"Files",segment:"Segment",block:"Block",velocities:"Velocities"};function Re(){var S,O;const[a,e]=x.exports.useState(),[n,t]=x.exports.useState(""),[i,s]=x.exports.useState({command:{name:"Command File",description:"A file pointing to all the other relevant files",extension:".json",currentFilePath:""},segment:{name:"Segment File",description:"A CSV containing the details of fault locations",extension:".csv",currentFilePath:""},block:{name:"Block File",description:"A CSV containing information on blocks/plates",extension:".csv",currentFilePath:""},velocities:{name:"Velocity Estimations",description:"A CSV containing velocity estimations for various points on the globe",extension:".csv",currentFilePath:""}}),[l,p]=x.exports.useState(),[d,m]=x.exports.useState(),[h,C]=x.exports.useState(),[$,M]=x.exports.useState(),[r,b]=x.exports.useState(Fe),[N,f]=x.exports.useState(ye),[c,g]=x.exports.useState(-1);let v=o("span",{});switch(n){case"files":v=a?o(be,{folder:a,files:i,setFile:async(u,k,j)=>{if(j){let D=w({},i);switch(D[u]=F(w({},D[u]),{currentFilePath:k}),u){case"segment":m(await Y(j));break;case"block":C(await ee(j));break;case"velocity":M(await te(j));break;case"command":const L=await Me(a,j,i);p(L.commands),m(L.segments),C(L.blocks),M(L.velocities),D=L.openableFiles;break}s(D)}}}):o("span",{});break;case"velocities":v=o(Ce,{settings:r,setSettings:b});break;case"block":v=o(xe,{settings:N,setSettings:f,selected:c,blocks:(S=h==null?void 0:h.data)!=null?S:[],setBlockData:(u,k)=>{if(h!==void 0){const j=h.data&&h.data[u]?w(w({},h.data[u]),k):Le(k),D=h.data?[...h.data]:[];D[u]=j;const L=h.clone();L.data=D,C(L)}}});break}return _("div",{className:"w-screen h-screen flex flex-col",children:[o(Se,{filesOpen:((O=l!=null?l:d)!=null?O:h)!==void 0,saveFiles:async()=>{l&&await l.save(),d&&await d.save(),h&&await h.save()},folder:a,openFolder:async()=>{const u=await Be();e(u),t("files")}}),o(Ne,{pointSources:[{name:"blocks",color:N.color,selectedColor:N.selectedColor,radius:N.radius,points:(h==null?void 0:h.data)?h.data.map((u,k)=>({longitude:u.interior_lon,latitude:u.interior_lat,name:u.name,description:"",selected:k===c,index:k})):[],clickPoint:(u,k)=>{console.log("Selected",k,u),g(u),t("block")}}],arrowSources:[{name:"velocity",color:r.color,scale:r.scale,arrowHeadScale:r.arrowHead,width:r.width,arrows:($==null?void 0:$.data)?$.data.map(u=>{const k=Math.sqrt(u.east_vel*u.east_vel+u.north_vel*u.north_vel);return{longitude:u.lon,latitude:u.lat,direction:[u.east_vel/k,u.north_vel/k],scale:k,name:u.name,description:`north: ${u.north_vel}, east: ${u.east_vel}`}}):[]}]}),o(ve,{view:v,buttons:a?ze:void 0,active:n,setActive:u=>t(u)})]})}function He(a={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:t,onRegistered:i,onRegisterError:s}=a;let l;const p=async(d=!0)=>{};return"serviceWorker"in navigator&&(l=new pe("./sw.js",{scope:"./"}),l.addEventListener("activated",d=>{d.isUpdate?window.location.reload():t==null||t()}),l.register({immediate:e}).then(d=>{i==null||i(d)}).catch(d=>{s==null||s(d)})),p}He();const Te=1,Ve=new ue({defaultOptions:{queries:{staleTime:Number.POSITIVE_INFINITY,retry:Te}}});fe.render(o(x.exports.StrictMode,{children:o(me,{client:Ve,children:o(Re,{})})}),document.querySelector("#root"));
