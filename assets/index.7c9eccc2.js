var be=Object.defineProperty,Ne=Object.defineProperties;var Se=Object.getOwnPropertyDescriptors;var le=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var U=(n,e,t)=>e in n?be(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,y=(n,e)=>{for(var t in e||(e={}))Ce.call(e,t)&&U(n,t,e[t]);if(le)for(var t of le(e))ke.call(e,t)&&U(n,t,e[t]);return n},$=(n,e)=>Ne(n,Se(e));var C=(n,e,t)=>(U(n,typeof e!="symbol"?e+"":e,t),t);import{j as Z,m as ce,r as g,a as K,M as Fe,v as $e,Q as Le,R as je,b as De}from"./vendor.2c6bff34.js";const Pe=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}};Pe();const s=Z.exports.jsx,x=Z.exports.jsxs,B=Z.exports.Fragment;function Oe({value:n,fieldDefinition:e,setField:t}){return x("div",{className:"flex flex-row justify-between items-center",children:[x("div",{className:"flex flex-col",children:[s("span",{"data-testid":`input-title-${e.name}`,className:"text-l font-bold",children:e.name}),e.description?s("span",{className:"text-sm",children:e.description}):s(B,{})]}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{"data-testid":`input-editor-${e.name}`,className:"rounded w-full",type:typeof n=="number"?"number":"text",value:n,onChange:o=>{t(typeof n=="number"?Number.parseFloat(o.target.value):o.target.value)}})})]})}function de({title:n,item:e,setItem:t,fieldDefinitions:o}){const r=Object.keys(e).map((a,l)=>{const p=e[a],i=a in o&&o[a];return i?{element:s(Oe,{value:p,fieldDefinition:i,setField:w=>t({[a]:w})},a),order:i.order}:{element:x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{"data-testid":`input-title-${a}`,className:"text-l font-bold",children:a}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{"data-testid":`input-editor-${a}`,className:"rounded w-full",type:typeof p=="number"?"number":"text",value:p,onChange:w=>{t({[a]:typeof p=="number"?Number.parseFloat(w.target.value):w.target.value})}})})]},a),order:l+1e3}}).sort((a,l)=>a.order-l.order).map(a=>a.element);return x("div",{className:"flex flex-col gap-2 border-2 rounded p-2 max-h-96 overflow-y-auto",children:[s("span",{"data-testid":"editable-item-title",className:"text-xl font-bold",children:n}),r]})}const Ie={color:"#0000ff",selectedColor:"#ff0000",radius:6};var ye;const Me=JSON.parse((ye=window.localStorage.getItem("blockDisplaySettings"))!=null?ye:"false")||Ie;function We({settings:n,setSettings:e,selected:t,blocks:o,setBlockData:r}){const a=i=>{e(i),window.localStorage.setItem("blockDisplaySettings",JSON.stringify(i))},l=o[t],p=l?s(de,{title:l.name,item:l,setItem:i=>r(t,i),fieldDefinitions:{name:{order:0,name:"Name",description:"The Block Name",type:"string"}}}):s(B,{});return x(B,{children:[x("div",{className:"flex flex-col gap-2",children:[x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Color"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"color",value:n.color,onChange:i=>{a($(y({},n),{color:i.target.value}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Selected Color"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"color",value:n.selectedColor,onChange:i=>{a($(y({},n),{selectedColor:i.target.value}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Radius"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"range",min:"2",max:"10",step:"0.5",value:n.radius,onChange:i=>{a($(y({},n),{radius:Number.parseFloat(i.target.value)}))}})})]})]}),p]})}function Ee({folder:n,files:e,setFile:t}){const o=Object.keys(e).map(r=>{const a=e[r];return x("div",{className:"flex flex-row justify-between items-center",children:[x("div",{className:"flex flex-col",children:[s("span",{className:"text-l font-bold","data-testid":`file-${r}-label`,children:a.name}),s("span",{className:"text-sm","data-testid":`file-${r}-description`,children:a.description})]}),s("span",{className:"w-2/5 flex-shrink-0",children:x("select",{"data-testid":`file-${r}-select`,className:"w-full rounded",value:a.currentFilePath,onChange:async l=>{const p=l.currentTarget.value;try{const i=await n.getFile(p);t(r,i.name,i)}catch{t(r,"")}},children:[s("option",{value:"","data-testid":`file-${r}-empty`,children:"\xA0"}),n.fileList.filter(l=>l.endsWith(a.extension)).map(l=>s("option",{value:l,"data-testid":`file-${r}-select-${l}`,children:l},l))]})})]},r)});return s("div",{className:"flex flex-col gap-2",children:o})}function Ae({view:n,buttons:e,active:t,setActive:o}){if(!e)return s("span",{});const r=[];for(const a of Object.keys(e)){const l=e[a],p=a===t;r.push(s("button",{type:"button","data-testid":`tab-${a}`,className:`${p?"bg-gray-100":"bg-gray-300"} p-2 shadow-inner hover:bg-gray-200 rounded-t`,onClick:()=>o(p?"":a),children:l},a))}return x("div",{"data-testid":"inspector-container",className:"absolute bottom-0 right-2 h-1/2 w-1/3 flex flex-col-reverse z-50",children:[t?s("div",{"data-testid":"inspector-view",className:"flex flex-col bg-gray-100 flex-grow rounded-tr p-2",children:n}):"",s("div",{"data-testid":"inspector-tabs",className:"flex flex-row rounded-sm gap-0 divide-x divide-gray-200",children:r})]})}ce.accessToken="pk.eyJ1IjoiYnJlbmRhbmptZWFkZSIsImEiOiJja3g2ZzVueWMybTJtMzFwaHdzZmV5OGJvIn0.Oz8qQnu5b-jx8XFHlFnKDQ";const R=Math.PI/6,J=2*Math.PI-R;function Be({pointSources:n,arrowSources:e,drawnLineSource:t,selections:o}){const r=g.exports.useRef(null),[a,l]=g.exports.useState(),[p,i]=g.exports.useState(!1),[w,N]=g.exports.useState(),[D]=g.exports.useState(new K.exports.Popup({closeButton:!1,closeOnClick:!1})),[P,T]=g.exports.useState({color:t.color,width:t.activeWidth,activeWidth:t.activeWidth,activeColor:t.activeColor,active:t.active}),[O,z]=g.exports.useState(),[M,H]=g.exports.useState(),[S,q]=g.exports.useState({}),[W,Q]=g.exports.useState({});return g.exports.useEffect(()=>{if(!a&&ce.accessToken&&r.current){const u=new K.exports.Map({container:r.current,style:"mapbox://styles/mapbox-public/ckngin2db09as17p84ejhe24y",center:[0,0],zoom:2});u.addControl(new K.exports.NavigationControl),l(u),u.on("load",()=>{i(!0)}),u.on("draw.selectionchange",({features:v})=>{var d;if(!((d=S.source)==null?void 0:d.clickLine))return;let f=-1;for(const h of v)if(h.geometry.type==="LineString"&&h.properties&&"index"in h.properties&&typeof h.properties.index=="number"){f=h.properties.index,w==null||w.changeMode("direct_select",{featureId:h.id});break}S.source.clickLine(f)}),u.on("draw.create",({features:v})=>{var d;if(console.log("CREATING LINE"),!((d=S.source)==null?void 0:d.createLine))return;const f=[];for(const h of v)if(h.geometry.type==="LineString")for(const m of h.geometry.coordinates)f.push({lon:m[0],lat:m[1]});f.length>1&&S.source.createLine(f)}),u.on("draw.update",({features:v})=>{var h;if(console.log("UPDATING LINE"),!((h=S.source)==null?void 0:h.updateLine))return;console.log("Got the function");const f=[];let d=-1;for(const m of v)if(m.geometry.type==="LineString"&&m.properties&&"index"in m.properties&&typeof m.properties.index=="number"){console.log("Found the feature"),d=m.properties.index;for(const _ of m.geometry.coordinates)f.push({lon:_[0],lat:_[1]});break}console.log("will call update function"),f.length>1&&d>-1&&(console.log("Calling update function"),S.source.updateLine(d,f))})}console.log("Updating map...")},[w,S,a]),g.exports.useEffect(()=>{if(a&&p&&S.source!==t){console.log("Drawning lines"),S.source=t,q(S);let u=w;(t.activeColor!==P.activeColor||t.activeWidth!==P.activeWidth||t.color!==P.color||t.width!==P.width)&&(T({color:t.color,width:t.activeWidth,activeWidth:t.activeWidth,activeColor:t.activeColor,active:t.active}),w&&a.removeControl(w),t.active?(u=new Fe({displayControlsDefault:!1,controls:{line_string:!0},defaultMode:"simple_select",styles:[{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":2*t.activeWidth,"circle-color":t.activeColor}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3*t.activeWidth+2,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3*t.activeWidth,"circle-color":t.activeColor}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":t.activeColor,"line-dasharray":[.2,2],"line-width":t.activeWidth}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","selected"],1],t.activeColor,t.color],"line-width":t.width}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":["case",["==",["get","selected"],1],t.activeColor,t.color],"line-width":t.width}}]}),a.addControl(u),N(u)):u=void 0),u&&u.set({type:"FeatureCollection",features:t.lines.flatMap(v=>[{type:"Feature",properties:{name:v.name,index:v.index,selected:o.drawnLine===v.index},id:v.index,geometry:{type:"LineString",coordinates:[[v.startLongitude,v.startLatitude],[v.endLongitude,v.endLatitude]]}}])})}},[a,p,S,t,P,w,o.drawnLine]),g.exports.useEffect(()=>{if(!a||!p)return;if(O!==n)if(console.log("Setting points in map!"),O){for(const f of O){const d=a.getSource(`point:${f.name}`);d!==void 0&&d.setData({type:"FeatureCollection",features:[]}),a.removeLayer(`layer:point:${f.name}`)}z(void 0)}else{for(const f of n){let d=a.getSource(`point:${f.name}`);const h=d===void 0;h&&(a.addSource(`point:${f.name}`,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),d=a.getSource(`point:${f.name}`)),d!==void 0&&d.setData({type:"FeatureCollection",features:f.points.map(m=>({type:"Feature",properties:{description:`<strong>${m.name}</strong><p>${m.description}</p>`,index:m.index,name:m.name,selected:m.index!==o[f.name]},geometry:{type:"Point",coordinates:[m.longitude,m.latitude]}}))}),a.addLayer({id:`layer:point:${f.name}`,type:"circle",source:`point:${f.name}`,paint:{"circle-color":["case",["get","selected"],f.selectedColor,f.color],"circle-radius":f.radius,"circle-stroke-width":1,"circle-stroke-color":"#ffffff"}}),h&&(a.on("mouseenter",`layer:point:${f.name}`,m=>{if(!m.features)return;const _=m.features[0];if(_.geometry.type==="Point"&&_.properties&&typeof _.properties.description=="string"){const L=[..._.geometry.coordinates],{description:I}=_.properties;for(;Math.abs(m.lngLat.lng-L[0])>180;)L[0]+=m.lngLat.lng>L[0]?360:-360;D.setLngLat(L).setHTML(I).addTo(a)}}),a.on("mouseleave",`layer:point:${f.name}`,()=>{D.remove()}),a.on("click",`layer:point:${f.name}`,m=>{if(!m.features||!f.clickPoint)return;const _=m.features[0];if(_.properties&&typeof _.properties.index=="number"&&typeof _.properties.name=="string"){const{index:L,name:I}=_.properties;f.clickPoint(L,I)}}))}z(n)}const u=y({},W);let v=!1;for(const f of Object.keys(o))if(o[f]!==W[f]){for(const d of n)if(d.name===f){v=!0,u[f]=o[f];const h=a.getSource(`point:${d.name}`);if(h){const m=o[f];h.setData({type:"FeatureCollection",features:d.points.map(_=>({type:"Feature",properties:{description:`<strong>${_.name}</strong><p>${_.description}</p>`,index:_.index,name:_.name,selected:_.index!==m},geometry:{type:"Point",coordinates:[_.longitude,_.latitude]}}))})}}}v&&Q(u)},[a,O,n,p,D,o,W]),g.exports.useEffect(()=>{if(a&&p&&M!==e)if(console.log("Setting arrows in map!"),M){for(const u of M){const v=a.getSource(`arrow:${u.name}`);v!==void 0&&v.setData({type:"FeatureCollection",features:[]}),a.removeLayer(`layer:arrow:${u.name}`)}H(void 0)}else{for(const u of e){let v=a.getSource(`arrow:${u.name}`);const f=v===void 0;f&&(a.addSource(`arrow:${u.name}`,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),v=a.getSource(`arrow:${u.name}`)),v!==void 0&&v.setData({type:"FeatureCollection",features:u.arrows.map((d,h)=>{const m=d.scale*u.scale,_=u.scale*u.arrowHeadScale,L=[d.longitude+d.direction[0]*m,d.latitude+d.direction[1]*m],I=[L[0]+(Math.cos(R)*-d.direction[0]-Math.sin(R)*-d.direction[1])*_,L[1]+(Math.sin(R)*-d.direction[0]+Math.cos(R)*-d.direction[1])*_],V=[L[0]+(Math.cos(J)*-d.direction[0]-Math.sin(J)*-d.direction[1])*_,L[1]+(Math.sin(J)*-d.direction[0]+Math.cos(J)*-d.direction[1])*_];return{type:"Feature",properties:{description:`<strong>${d.name}</strong><p>${d.description}</p>`,index:h,name:d.name},geometry:{type:"LineString",coordinates:[[d.longitude,d.latitude],L,I,L,V]}}})}),a.addLayer({id:`layer:arrow:${u.name}`,type:"line",source:`arrow:${u.name}`,layout:{"line-cap":"round","line-join":"miter"},paint:{"line-color":u.color,"line-width":u.width}}),f&&(a.on("mouseenter",`layer:arrow:${u.name}`,d=>{if(!d.features)return;const h=d.features[0];if(h.geometry.type==="Point"&&h.properties&&typeof h.properties.description=="string"){const m=[...h.geometry.coordinates],{description:_}=h.properties;for(;Math.abs(d.lngLat.lng-m[0])>180;)m[0]+=d.lngLat.lng>m[0]?360:-360;D.setLngLat(m).setHTML(_).addTo(a)}}),a.on("mouseleave",`layer:arrow:${u.name}`,()=>{D.remove()}),a.on("click",`layer:arrow:${u.name}`,d=>{if(!d.features||!u.clickArrow)return;const h=d.features[0];if(h.properties&&typeof h.properties.index=="number"&&typeof h.properties.name=="string"){const{index:m,name:_}=h.properties;u.clickArrow(m,_)}}))}H(e)}},[a,M,e,p,D]),s("div",{"data-testid":"map",className:"w-full h-full",ref:r})}const Re={color:"#ffff00",width:1,activeColor:"#00ffff",activeWidth:2};var ve;const Te=JSON.parse((ve=window.localStorage.getItem("segmentDisplaySettings"))!=null?ve:"false")||Re;function ze({settings:n,setSettings:e,segments:t,selected:o,setSegmentData:r}){const a=i=>{e(i),window.localStorage.setItem("segmentDisplaySettings",JSON.stringify(i))},l=t[o],p=l?s(de,{title:l.name,item:l,setItem:i=>r(o,i),fieldDefinitions:{name:{order:0,name:"Name",description:"The Block Name",type:"string"}}}):s(B,{});return x("div",{className:"flex flex-col gap-2",children:[x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Color"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"color",value:n.color,onChange:i=>{a($(y({},n),{color:i.target.value}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Width"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"range",min:"0.1",max:"2",step:"0.1",value:n.width,onChange:i=>{a($(y({},n),{width:Number.parseFloat(i.target.value)}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Active Color"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"color",value:n.activeColor,onChange:i=>{a($(y({},n),{activeColor:i.target.value}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Active Width"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"range",min:"0.1",max:"2",step:"0.1",value:n.activeWidth,onChange:i=>{a($(y({},n),{activeWidth:Number.parseFloat(i.target.value)}))}})})]}),p]})}function He({folder:n,openFolder:e,filesOpen:t,saveFiles:o}){function r(){e()}return x("div",{"data-testid":"topbar",className:"p-2 bg-gradient-to-r from-blue-700 to-green-700 text-white flex flex-row justify-between",children:[s("h3",{className:"text-lg font-bold",children:"Celeri UI"}),x("span",{"data-testid":"open-folder-topbar",className:"flex flex-row gap-2 items-center",children:[n?x("span",{children:["Working in ",n.name]}):s("button",{type:"button",onClick:r,"data-testid":"open-folder-button",children:"Open Folder"}),t?s("button",{type:"button",onClick:o,"data-testid":"save-file-button",children:"Save Files"}):s(B,{})]})]})}const Ve={color:"#ffff00",scale:.02,width:1,arrowHead:1};var xe;const Je=JSON.parse((xe=window.localStorage.getItem("velocityDisplaySettings"))!=null?xe:"false")||Ve;function Ge({settings:n,setSettings:e}){const t=o=>{e(o),window.localStorage.setItem("velocityDisplaySettings",JSON.stringify(o))};return x("div",{className:"flex flex-col gap-2",children:[x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Color"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"color",value:n.color,onChange:o=>{t($(y({},n),{color:o.target.value}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Scale"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"range",min:"0.001",max:"0.1",step:"0.001",value:n.scale,onChange:o=>{t($(y({},n),{scale:Number.parseFloat(o.target.value)}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Width"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"range",min:"0.1",max:"2",step:"0.1",value:n.width,onChange:o=>{t($(y({},n),{width:Number.parseFloat(o.target.value)}))}})})]}),x("div",{className:"flex flex-row justify-between items-center",children:[s("span",{className:"text-l font-bold",children:"Arrow Head Size"}),s("span",{className:"w-2/5 flex-shrink-0",children:s("input",{className:"rounded w-full",type:"range",min:"0.5",max:"5",step:"0.1",value:n.arrowHead,onChange:o=>{t($(y({},n),{arrowHead:Number.parseFloat(o.target.value)}))}})})]})]})}function X(n){const e=n.split(/\n/g),t=e[0].split(","),o=e.slice(1),r=[];for(const a of o){const l=a.split(/\s*,\s*/),p={};for(let i=0;i<t.length;i+=1){let w=l[i];const N=t[i],D=Number.parseFloat(w);w=Number.isNaN(D)?w:D,typeof w=="string"&&w.startsWith('"')&&w.endsWith('"')&&(w=w.slice(1,-1)),p[N]=w}r.push(p)}return r}function Y(n,e){const t=[e.join(",")];for(const o of n){const r=o;t.push(e.map(a=>a in r?typeof r[a]=="string"&&/\s/.test(`${r[a]}`)?`"${r[a]}"`:`${r[a]}`:"").join(","))}return t.join(`
`)}const pe=["other1","other2","other3","other4","other5","other6","name","interior_lon","interior_lat","euler_lon","euler_lon_sig","euler_lat","euler_lat_sig","rotation_rate","rotation_rate_sig","rotation_flag","apriori_flag","strain_rate","strain_rate_sig","strain_rate_flag"],qe={other1:0,other2:0,other3:0,other4:0,other5:0,other6:0,name:"",interior_lon:0,interior_lat:0,euler_lon:0,euler_lon_sig:0,euler_lat:0,euler_lat_sig:0,rotation_rate:0,rotation_rate_sig:0,rotation_flag:0,apriori_flag:0,strain_rate:0,strain_rate_sig:0,strain_rate_flag:0};function Qe(n){return y(y({},qe),n)}class ee{constructor(e){C(this,"handle");C(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),o=X(e).map(r=>{const a={};for(const l of pe)a[l]=r[l]||(l==="name"?"":0);return a});this.data=o}async save(){var t;const e=Y((t=this.data)!=null?t:[],pe);await this.handle.setContents(e)}clone(){return new ee(this.handle)}}const Ue={file_name:"basic_command_default_values.json",reuse_elastic:"no",reuse_elastic_file:"./celeri_elastic_operators.hdf5",save_elastic:"yes",save_elastic_file:"./celeri_elastic_operators.hdf5",material_lambda:3e10,material_mu:3e10,unit_sigmas:"no",locking_depth_flag2:0,locking_depth_flag3:0,locking_depth_flag4:0,locking_depth_flag5:0,locking_depth_override_flag:"no",locking_depth_overide_value:0,apriori_block_name:"",tri_smooth:1e4,pmag_tri_smooth:0,smooth_type:1,n_iterations:1,tri_edge:[0,0,0],tri_depth_tolerance:0,tri_con_weight:1,strain_method:0,sar_file_name:"",sar_ramp:0,sar_weight:0,tri_slip_constraint_type:0,inversion_type:"standard",inversion_param01:0,inversion_param02:0,inversion_param03:0,inversion_param04:0,inversion_param05:0,save_all:"yes",mogi_file_name:"",solution_method:"backslash",ridge_param:0,tri_full_coupling:"no",tvr_lambda:1,tri_slip_sign:[0,0],n_eigs:0,segment_file_name:"",station_file_name:"",block_file_name:"",mesh_parameters_file_name:"",fault_resolution:1,station_data_weight:1,station_data_weight_min:1,station_data_weight_max:1,station_data_weight_steps:1,slip_constraint_weight:1,slip_constraint_weight_min:1,slip_constraint_weight_max:1,slip_constraint_weight_steps:1,block_constraint_weight:1,block_constraint_weight_min:1,block_constraint_weight_max:1,block_constraint_weight_steps:1,slip_file_names:""};function Ze(n){return y(y({},Ue),n)}class te{constructor(e){C(this,"handle");C(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),t=JSON.parse(e);this.data=Ze(t)}async save(){if(this.data){const e=JSON.stringify(this.data);await this.handle.setContents(e)}}clone(){return new te(this.handle)}}const fe=["name","lon1","lat1","lon2","lat2","dip","res","other3","other6","other7","other8","other9","other10","other11","other12","locking_depth","locking_depth_sig","locking_depth_flag","dip_sig","dip_flag","ss_rate","ss_rate_sig","ss_rate_flag","ds_rate","ds_rate_sig","ds_rate_flag","ts_rate","ts_rate_sig","ts_rate_flag","burial_depth","burial_depth_sig","burial_depth_flag","resolution_override","resolution_other","patch_file_name","patch_flag","patch_slip_file","patch_slip_flag"],ue={name:"unnamed segment",lon1:0,lat1:0,lon2:0,lat2:0,dip:0,res:0,other3:0,other6:0,other7:0,other8:0,other9:0,other10:0,other11:0,other12:0,locking_depth:0,locking_depth_sig:0,locking_depth_flag:0,dip_sig:0,dip_flag:0,ss_rate:0,ss_rate_sig:0,ss_rate_flag:0,ds_rate:0,ds_rate_sig:0,ds_rate_flag:0,ts_rate:0,ts_rate_sig:0,ts_rate_flag:0,burial_depth:0,burial_depth_sig:0,burial_depth_flag:0,resolution_override:0,resolution_other:0,patch_file_name:0,patch_flag:0,patch_slip_file:0,patch_slip_flag:0};function G(n,e){const t=e!=null?e:ue;let o=n[0];const r=[];for(let a=1;a<n.length;a+=1){const l=n[a],p=$(y({},t),{lon1:o.lon,lat1:o.lat,lon2:l.lon,lat2:l.lat});r.push(p),o=l}return r}function Ke(n){return y(y({},ue),n)}class ae{constructor(e){C(this,"handle");C(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),o=X(e).map(r=>{const a={};for(const l of fe)a[l]=r[l]||(l==="name"?"":0);return a});this.data=o}async save(){var t;const e=Y((t=this.data)!=null?t:[],fe);await this.handle.setContents(e)}clone(){return new ae(this.handle)}}const me=["lon","lat","corr","other1","name","east_vel","north_vel","east_sig","north_sig","flag","up_vel","up_sig","east_adjust","north_adjust","up_adjust"];class ne{constructor(e){C(this,"handle");C(this,"data");this.handle=e,this.data=void 0}async initialize(){const e=await this.handle.getContents(),o=X(e).map(r=>{const a={};for(const l of me)a[l]=r[l]||(l==="name"?"":0);return a});this.data=o}async save(){var t;const e=Y((t=this.data)!=null?t:[],me);await this.handle.setContents(e)}clone(){return new ne(this.handle)}}async function he(n){const e=new ae(n);return await e.initialize(),e}async function ge(n){const e=new ee(n);return await e.initialize(),e}async function _e(n){const e=new ne(n);return await e.initialize(),e}async function Xe(n,e,t){const o=new te(e);if(await o.initialize(),o.data){const r=await he(await n.getFile(o.data.segment_file_name)),a=await ge(await n.getFile(o.data.block_file_name)),l=await _e(await n.getFile(o.data.station_file_name)),p=y({},t);return"command"in p&&(p.command=$(y({},p.command),{currentFilePath:e.name})),"segment"in p&&(p.segment=$(y({},p.segment),{currentFilePath:o.data.segment_file_name})),"block"in p&&(p.block=$(y({},p.block),{currentFilePath:o.data.block_file_name})),"velocities"in p&&(p.velocities=$(y({},p.velocities),{currentFilePath:o.data.station_file_name})),{openableFiles:p,commands:o,segments:r,blocks:a,velocities:l}}throw new Error("Can't open command file")}class Ye{constructor(e){C(this,"name");C(this,"handle");this.handle=e,this.name=e.name}async getContents(){return(await this.handle.getFile()).text()}async setContents(e){const t=await this.handle.createWritable();await t.write(e),await t.close()}}class ie{constructor(e){C(this,"name");C(this,"handle");C(this,"fileList");C(this,"folderList");this.handle=e,this.fileList=[],this.folderList=[],this.name=e.name}async initialize(){for await(const e of this.handle.values())e.kind==="directory"?this.folderList.push(e.name):this.fileList.push(e.name)}async getFile(e){if(!this.fileList.includes(e))throw new Error("Missing File");const t=await this.handle.getFileHandle(e);return new Ye(t)}async getDirectory(e){if(!this.folderList.includes(e))throw new Error("Missing Directory");const t=await this.handle.getDirectoryHandle(e),o=new ie(t);return await o.initialize(),o}}const et=async()=>{const n=await window.showDirectoryPicker(),e=new ie(n);return await e.initialize(),e};class tt{constructor(e,t){C(this,"name");C(this,"parent");this.name=e,this.parent=t}async getContents(){const e=this.parent[this.name];if(typeof e!="string")throw new Error("No Such File");return e}async setContents(e){this.parent[this.name]=e}}class oe{constructor(e,t){C(this,"name");C(this,"parent");C(this,"fileList");C(this,"folderList");this.name=e,this.parent=t,this.fileList=[],this.folderList=[];const o=t[e];for(const r of Object.keys(o))typeof o[r]=="string"?this.fileList.push(r):this.folderList.push(r)}async getFile(e){if(!this.fileList.includes(e))throw new Error("No Such File");return new tt(e,this.parent[this.name])}async getDirectory(e){if(!this.folderList.includes(e))throw new Error("No Such File");return new oe(e,this.parent[this.name])}}const at=async n=>new oe("root",n);let we=async()=>{var e;return at((e=window.FakeDirectory)!=null?e:{})};function nt(n){we=n}async function it(){return we()}window.location.search.includes("fake-dir")||nt(et);const ot={files:"Files",segment:"Segment",block:"Block",velocities:"Velocities"};function st(){var V,se,re;const[n,e]=g.exports.useState(),[t,o]=g.exports.useState(""),[r,a]=g.exports.useState({command:{name:"Command File",description:"A file pointing to all the other relevant files",extension:".json",currentFilePath:""},segment:{name:"Segment File",description:"A CSV containing the details of fault locations",extension:".csv",currentFilePath:""},block:{name:"Block File",description:"A CSV containing information on blocks/plates",extension:".csv",currentFilePath:""},velocities:{name:"Velocity Estimations",description:"A CSV containing velocity estimations for various points on the globe",extension:".csv",currentFilePath:""}}),[l,p]=g.exports.useState(),[i,w]=g.exports.useState(),[N,D]=g.exports.useState(),[P,T]=g.exports.useState(),[O,z]=g.exports.useState(Je),[M,H]=g.exports.useState(Me),[S,q]=g.exports.useState(Te),[W,Q]=g.exports.useState(-1),[u,v]=g.exports.useState(-1),[f,d]=g.exports.useState([]),[h,m]=g.exports.useState([]),[_,L]=g.exports.useState({color:S.color,activeColor:S.activeColor,activeWidth:S.activeWidth,width:S.width,active:i!==void 0,lines:[],clickLine:c=>{v(c),o("segment")},createLine:c=>{if(console.log("Creating line @",c),i==null?void 0:i.data){const b=G(c),F=[...i.data,...b],k=i.clone();k.data=F,w(k)}},updateLine:(c,b)=>{var F;if(console.log("update line @",c),(F=i==null?void 0:i.data)==null?void 0:F[c]){const k=i.data[c],j=G(b,k),E=[...i.data];E.splice(c,1,...j);const A=i.clone();A.data=E,w(A)}}});g.exports.useEffect(()=>{d([{name:"blocks",color:M.color,selectedColor:M.selectedColor,radius:M.radius,points:(N==null?void 0:N.data)?N.data.map((c,b)=>({longitude:c.interior_lon,latitude:c.interior_lat,name:c.name,description:"",index:b})):[],clickPoint:(c,b)=>{Q(c),o("block")}}])},[M,N]),g.exports.useEffect(()=>{m([{name:"velocity",color:O.color,scale:O.scale,arrowHeadScale:O.arrowHead,width:O.width,arrows:(P==null?void 0:P.data)?P.data.map(c=>{const b=Math.sqrt(c.east_vel*c.east_vel+c.north_vel*c.north_vel);return{longitude:c.lon,latitude:c.lat,direction:[c.east_vel/b,c.north_vel/b],scale:b,name:c.name,description:`north: ${c.north_vel}, east: ${c.east_vel}`}}):[]}])},[O,P]),g.exports.useEffect(()=>{L({color:S.color,activeColor:S.activeColor,activeWidth:S.activeWidth,width:S.width,active:i!==void 0,lines:(i==null?void 0:i.data)?i.data.map((c,b)=>({startLongitude:c.lon1,endLongitude:c.lon2,startLatitude:c.lat1,endLatitude:c.lat2,name:c.name,index:b,description:""})):[],clickLine:c=>{v(c),o("segment")},createLine:c=>{if(i==null?void 0:i.data){const b=G(c),F=[...i.data,...b],k=i.clone();k.data=F,w(k)}},updateLine:(c,b)=>{var F;if(console.log("update line @",c),(F=i==null?void 0:i.data)==null?void 0:F[c]){const k=i.data[c],j=G(b,k),E=[...i.data];E.splice(c,1,...j);const A=i.clone();A.data=E,w(A)}}})},[S,i]);let I=s("span",{});switch(t){case"files":I=n?s(Ee,{folder:n,files:r,setFile:async(c,b,F)=>{if(F){let k=y({},r);switch(k[c]=$(y({},k[c]),{currentFilePath:b}),c){case"segment":w(await he(F));break;case"block":D(await ge(F));break;case"velocity":T(await _e(F));break;case"command":const j=await Xe(n,F,r);p(j.commands),w(j.segments),D(j.blocks),T(j.velocities),k=j.openableFiles;break}a(k)}}}):s("span",{});break;case"velocities":I=s(Ge,{settings:O,setSettings:z});break;case"block":I=s(We,{settings:M,setSettings:H,selected:W,blocks:(V=N==null?void 0:N.data)!=null?V:[],setBlockData:(c,b)=>{if(N!==void 0){const F=N.data&&N.data[c]?y(y({},N.data[c]),b):Qe(b),k=N.data?[...N.data]:[];k[c]=F;const j=N.clone();j.data=k,D(j)}}});break;case"segment":I=s(ze,{settings:S,setSettings:q,segments:(se=i==null?void 0:i.data)!=null?se:[],selected:u,setSegmentData:(c,b)=>{if(i!==void 0){const F=i.data&&i.data[c]?y(y({},i.data[c]),b):Ke(b),k=i.data?[...i.data]:[];k[c]=F;const j=i.clone();j.data=k,w(j)}}});break}return x("div",{className:"w-screen h-screen flex flex-col",children:[s(He,{filesOpen:((re=l!=null?l:i)!=null?re:N)!==void 0,saveFiles:async()=>{l&&await l.save(),i&&await i.save(),N&&await N.save()},folder:n,openFolder:async()=>{const c=await it();e(c),o("files")}}),s(Be,{pointSources:f,arrowSources:h,drawnLineSource:_,selections:{drawnLine:u,blocks:W}}),s(Ae,{view:I,buttons:n?ot:void 0,active:t,setActive:c=>o(c)})]})}function rt(n={}){const{immediate:e=!1,onNeedRefresh:t,onOfflineReady:o,onRegistered:r,onRegisterError:a}=n;let l;const p=async(i=!0)=>{};return"serviceWorker"in navigator&&(l=new $e("./sw.js",{scope:"./"}),l.addEventListener("activated",i=>{i.isUpdate?window.location.reload():o==null||o()}),l.register({immediate:e}).then(i=>{r==null||r(i)}).catch(i=>{a==null||a(i)})),p}rt();const lt=1,ct=new Le({defaultOptions:{queries:{staleTime:Number.POSITIVE_INFINITY,retry:lt}}});je.render(s(g.exports.StrictMode,{children:s(De,{client:ct,children:s(st,{})})}),document.querySelector("#root"));
